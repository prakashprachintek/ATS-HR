<sb-layout-dashboard>
    <sb-dashboard-head title="Applicants" [hideBreadcrumbs]="false"></sb-dashboard-head>
<div class="row">
  <div class="col-sm-2">
    <!-- <h2 style="float: left;"> <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16" (click)="iconDropdown()" style="width: 25px;">
      <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z " />
    </svg><span class="fa fa-download form-control-feedback" style="font-size: smaller;cursor: pointer;" (click)="downloadReport()"></span></h2> -->
    
    </div>
  <!-- <div class="col-sm-3">
    <i class="fa fa-filter" aria-hidden="true" (click)="iconDropdown()" style="margin-right: 5%;"></i>
     </div> -->
     <div class="col-sm-2" style="width: 74px;">
      <!-- <i class="bi bi-filter" aria-hidden="true" (click)="iconDropdown()" style="margin-right: 5%;"></i> -->
    </div>
  <div class="col-sm-4">
    <div class="form-group has-search">
      <span class="fa fa-search form-control-feedback"></span>
      <input type="text" class="form-control" placeholder="Search by Name, Email, Phone" [(ngModel)]="searchText" (keyup.enter)="filterData()">
    </div>
       <!-- <lucide-icon name="filter"></lucide-icon> -->
     <!-- <i class="bi bi-filter" style="width: 50px;
     height: 50px;" ></i> -->
  </div>
  <div class="col-sm-4" style="width: 300px; display: flex;">
    <div class="upload-form" style="margin-right: 5px;cursor: pointer;">
      <div class="upload-btn-wrapper rounded-pill">
        <button class="btn" [routerLink]="['/applicants/applicant-user-data']">Upload</button>
      </div>
    </div>
    
    <button class="btn btn-primary rounded-pill" (click)="addNewApplicant()"  style=" height: 44px;" >Add New +</button> 
    <h2 style="float: left;"> <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16" (click)="iconDropdown()" style="width: 25px;margin-left: 10px;">
      <path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z " />
    </svg><span class="fa fa-download form-control-feedback" style="font-size: smaller;cursor: pointer;margin-left: 10px;" (click)="downloadReport()"></span></h2>
    
  </div>
</div>
<div id="datatable">
</div>

<div class="container" *ngIf="popUp">
  <svg xmlns="http://www.w3.org/2000/svg" style="float: right;" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x" (click)="iconDropdown()"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
  <div class="content">
    <!-- <form action="#"> -->
      <div class="user-details row" style="margin-left: 0px;">
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
          <span class="details">Assignee</span>
          <select class="ui search dropdown" [(ngModel)]="assigneeFilter">
              <option value="">Please Select</option>
              <option *ngFor="let assignee of assigneeList" [value]="assignee._id">{{assignee.first_name}} {{assignee.last_name}}</option>
         </select>
        </div>
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
          <span class="details">Status</span>
          <select class="ui search dropdown" [(ngModel)]="statusFilter">
            <option value="">Please Select</option>
            <option value="Got Job">Got Job</option>
            <option value="Followup">Follow up</option>
       </select>
        </div>
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
          <span class="details">Qualification</span>
          <select class="ui search dropdown" [(ngModel)]="qualification">
            <option value="">Please Select</option>
            <option value="BE">BE </option>
            <option value="BA">BA </option>
            <option value="BSC">BSC </option>
            <option value="Diploma">Diploma</option>
            <option value="PUC">PUC</option>
            <option value="MTech">M.Tech</option>
            <option value="BSC">BSC</option>
            </select>
        </div>
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
          <span class="details">Applicant Type</span>
          <select class="ui search dropdown" [(ngModel)]="applicantType">
            <option value="">Please Select</option>
            <option value="Fresher">Fresher </option>
            <option value="Experience">Experience</option>
            <option value="IT">IT</option>
            <option value="NonIT">Non IT</option>
          </select>
        </div>
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
            <span class="details">Start Date</span>
            <input type="date" id="startDate"  [max]="maxDate" class="ui" (change)="startDatedd($event);">
        </div>
        <div class="input-box" class="col-sm-4" style="margin-top: 15px;">
          <span class="details">End</span>
          <input type="date"   max="{{date | date:'YYYY-MM-dd'}}" class="ui" (change)="endDatedd($event);">
        </div>
        <div class="col-sm-6" style="margin-top: 15px;">
          <input type="submit" value="Apply" (click)="apply()">
        </div>
      </div>
      
    <!-- </form> -->
  </div>
</div>

<div class="card" style="flex-grow: 1;" >
  <div class="header">
    <div class="table-responsive">

      <table mat-table matSort class="table table-hover  border-light" (matSortChange)="sortData($event)" 
        [dataSource]="dataSource"  >
        <!-- Name Column -->
        <ng-container matColumnDef="first_name">
          <th mat-header-cell mat-sort-header="first_name" *matHeaderCellDef> Name </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;"> {{element.first_name}} {{element.last_name}} </td>
        </ng-container>

        <ng-container matColumnDef="email">
          <th mat-header-cell mat-sort-header="email" *matHeaderCellDef> Email </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;"> {{element.email?element.email:"NA"}} </td>
        </ng-container>


        <ng-container matColumnDef="phone_number">
          <th mat-header-cell mat-sort-header="phone_number" *matHeaderCellDef> Phone </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;">
            <img class="" style="max-width: 1rem;;" src="assets/img/whatsapp.webp" />
             {{element.phone_number}} </td>
        </ng-container>
        <!-- <i class="fa fa-whatsapp" (click)="selectMessageData(element.phone_number)" style="cursor: pointer;" data-toggle="modal" data-target="#exampleModalScrollable"></i> -->

        <ng-container matColumnDef="applicant_type">
          <th mat-header-cell mat-sort-header="applicant_type" *matHeaderCellDef> Applicant Type </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;"> {{element.applicant_type}} </td>
        </ng-container>

        <ng-container matColumnDef="assignee">
          <th mat-header-cell mat-sort-header="assignee" *matHeaderCellDef> Assignee </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;"> {{element.assigneeDetails.length>0?element.assigneeDetails[0].first_name:"NA"}} {{element.assigneeDetails.length>0?element.assigneeDetails[0].last_name:""}} </td>
        </ng-container>

        <ng-container matColumnDef="status">
            <th mat-header-cell mat-sort-header="status" *matHeaderCellDef>Status </th>
            <td mat-cell *matCellDef="let element" style="text-align: left;padding-top: 10px;"> <i class='fa fa-comment-o' style="cursor: pointer;" [matTooltip]="getComments(element.comments)"></i>&nbsp;{{element.status}} </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell mat-sort-header="action" *matHeaderCellDef> Action </th>
          <td mat-cell *matCellDef="let element" style="text-align: left;">
            <div class="dropdown">
              <button class="dropbtn">
                <div>
                  &#xFE19;
                </div>
                <div class="dropdown-content">
                  <a href="#" [routerLink]="['/applicants/applicant-update', element._id]">Edit</a>
                  <a href="#" [routerLink]="['/applicants/applicant-details', element._id]">View</a>
                  <a (click)="deleteApplicant(element)">Delete</a>
                </div>
              </button>
            </div>
          </td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      </table>
      
      <!-- <div class='loader flex flex-row' *ngIf="formatDataLoading" id='loader-2'
        style="text-align: center;margin-right: auto;margin-left: auto;">
        <span></span><span></span><span></span>
      </div> -->

    </div>
  </div>
  <p *ngIf="userList.length==0 && !formatDataLoading">No Records</p>
  <mat-paginator [length]= totalRecords
  [pageSize]=pageSize
  [pageIndex]=currentPage
  (page)="handlePage($event)"
  [pageSizeOptions]="[2, 5, 10, 25, 100]"
  showFirstLastButtons
  aria-label="Select page">
</mat-paginator>
</div>
</sb-layout-dashboard>

<div class="modal fade" id="exampleModalScrollable" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable" style="margin-top: 80px;" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalScrollableTitle">Communicate via WhatsApp</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <label>Message</label>
        <textarea placeholder="Enter Message" [(ngModel)]="messageValue"  class="form-control" rows="8" cols="63"></textarea>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="sendMessage()">Send</button>
      </div>
    </div>
  </div>
</div>